import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.util.ArrayList;
import java.util.List;

abstract class AbstractTask {
    protected String taskId;
    protected String taskName;
    protected String taskDescription;

    public AbstractTask(String taskId, String taskName, String taskDescription) {
        this.taskId = taskId;
        this.taskName = taskName;
        this.taskDescription = taskDescription;
    }

    public abstract String getStatus();
    public abstract void setStatus(String status);

    public String getTaskId() { return taskId; }
    public String getTaskName() { return taskName; }
    public String getTaskDescription() { return taskDescription; }
}

class Task extends AbstractTask {
    private String status;

    public Task(String id, String name, String desc, String status) {
        super(id, name, desc);
        this.status = status;
    }

    @Override
    public String getStatus() { return status; }
    @Override
    public void setStatus(String status) { this.status = status; }
}

class TimedTask extends Task {
    private int estimatedMinutes;

    public TimedTask(String id, String name, String desc, String status, int mins) {
        super(id, name, desc, status);
        this.estimatedMinutes = mins;
    }

    public int getEstimatedMinutes() { return estimatedMinutes; }
    public void setEstimatedMinutes(int mins) { this.estimatedMinutes = mins; }
}

class TaskManager {
    private List<AbstractTask> taskList = new ArrayList<>();

    public void addTask(AbstractTask task) {
        taskList.add(task);
    }

    public List<AbstractTask> getAllTasks() {
        return taskList;
    }
}

class TaskForm extends JFrame {
    public TaskForm(TaskManager manager, TaskListViewer parent) {
        setTitle("Add Task");
        setSize(350, 300);
        setLayout(new GridLayout(5, 2, 5, 5));
        setLocationRelativeTo(parent);

        JTextField txtId = new JTextField("T-" + (manager.getAllTasks().size() + 1));
        txtId.setEditable(false);
        JTextField txtName = new JTextField();
        JTextArea txtDesc = new JTextArea();
        JComboBox<String> cbStatus = new JComboBox<>(new String[]{"Not Started", "Ongoing", "Completed"});
        JButton btnSave = new JButton("Save Task");

        add(new JLabel(" Task ID:")); add(txtId);
        add(new JLabel(" Task Name:")); add(txtName);
        add(new JLabel(" Description:")); add(new JScrollPane(txtDesc));
        add(new JLabel(" Status:")); add(cbStatus);
        add(new JLabel("")); add(btnSave);

        btnSave.addActionListener(e -> {
            if(txtName.getText().trim().isEmpty()) {
                JOptionPane.showMessageDialog(this, "Please fill in Task Name!", "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            Task t = new Task(txtId.getText(), txtName.getText(), txtDesc.getText(), (String)cbStatus.getSelectedItem());
            manager.addTask(t);
            parent.refreshTable();
            dispose();
        });
    }
}

class TaskListViewer extends JFrame {
    private TaskManager manager;
    private JTable table;
    private DefaultTableModel model;
    private TaskForm formWindow = null;

    public TaskListViewer(TaskManager manager) {
        this.manager = manager;
        setTitle("To-Do List Viewer");
        setSize(600, 400);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);

        JButton btnAdd = new JButton("Add Task");
        btnAdd.addActionListener(e -> {
            if (formWindow == null || !formWindow.isVisible()) {
                formWindow = new TaskForm(manager, this);
                formWindow.setVisible(true);
            }
        });

        JPanel topPanel = new JPanel();
        topPanel.add(btnAdd);
        add(topPanel, BorderLayout.NORTH);

        String[] columns = {"Task ID", "Task Name", "Description", "Status"};
        model = new DefaultTableModel(columns, 0);
        table = new JTable(model);
        add(new JScrollPane(table), BorderLayout.CENTER);
    }

    public void refreshTable() {
        model.setRowCount(0);
        for (AbstractTask t : manager.getAllTasks()) {
            model.addRow(new Object[]{t.getTaskId(), t.getTaskName(), t.getTaskDescription(), t.getStatus()});
        }
    }
}

public class MainApp {
    public static void main(String[] args) {
        try { UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); } catch (Exception e) {}
        
        TaskManager manager = new TaskManager();
        TaskListViewer gui = new TaskListViewer(manager);
        gui.setVisible(true);
    }
}

